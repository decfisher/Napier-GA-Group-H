/*1*/
SELECT CODE, NAME, CONTINENT, REGION, POPULATION, CAPITAL
FROM COUNTRY
ORDER BY POPULATION DESC;

/*2*/
CREATE PROCEDURE GetData(@ContName CHAR(100)) 
AS BEGIN

SELECT CODE, NAME, CONTINENT, REGION, POPULATION, CAPITAL
FROM COUNTRY
WHERE CONTINENT = "@ContName"
ORDER BY POPULATION DESC;

/*3*/
CREATE PROCEDURE GetData(@RegionName CHAR(100)) 
AS BEGIN

SELECT CODE, NAME, CONTINENT, REGION, POPULATION, CAPITAL
FROM COUNTRY
WHERE REGION = "@RegionName"
ORDER BY POPULATION DESC;

/*4*/
CREATE PROCEDURE GetData(@CountryNum INT) 
AS BEGIN

SELECT CODE, NAME, CONTINENT, REGION, POPULATION, CAPITAL
FROM COUNTRY
ORDER BY POPULATION DESC
LIMIT @CountryNum;

/*5*/
CREATE PROCEDURE GetData(@ContName CHAR(100), @CountryNum INT) 
AS BEGIN

SELECT CODE, NAME, CONTINENT, REGION, POPULATION, CAPITAL
FROM COUNTRY
WHERE CONTINENT = "@ContName"
ORDER BY POPULATION DESC
LIMIT @CountryNum;

/*6*/
CREATE PROCEDURE GetData(@RegionName CHAR(100), @CountryNum INT) 
AS BEGIN

SELECT CODE, NAME, CONTINENT, REGION, POPULATION, CAPITAL
FROM COUNTRY
WHERE REGION = "@RegionName"
ORDER BY POPULATION DESC
LIMIT @CountryNum;

/*7*/
SELECT A.NAME, B.NAME as COUNTRY, A.DISTRICT, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
ORDER BY A.POPULATION DESC;

/*8*/
CREATE PROCEDURE GetData(@ContName CHAR(100)) 
AS BEGIN

SELECT A.NAME, B.NAME as COUNTRY, A.DISTRICT, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
WHERE B.CONTINENT = "@ContName"
ORDER BY A.POPULATION DESC;

/*9*/
CREATE PROCEDURE GetData(@RegionName CHAR(100)) 
AS BEGIN

SELECT A.NAME, B.NAME as COUNTRY, A.DISTRICT, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
WHERE B.REGION = "@RegionName"
ORDER BY A.POPULATION DESC;

/*10*/
CREATE PROCEDURE GetData(@CountryName CHAR(100)) 
AS BEGIN

SELECT A.NAME, B.NAME as COUNTRY, A.DISTRICT, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
WHERE B.NAME = "@CountryName"
ORDER BY A.POPULATION DESC;

/*11*/
CREATE PROCEDURE GetData(@DistrictName CHAR(100)) 
AS BEGIN

SELECT A.NAME, B.NAME as COUNTRY, A.DISTRICT, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
WHERE A.DISTRICT = "@DistrictName"
ORDER BY A.POPULATION DESC;

/*12*/
CREATE PROCEDURE GetData(@CountryNum INT) 
AS BEGIN

SELECT A.NAME, B.NAME as COUNTRY, A.DISTRICT, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
ORDER BY A.POPULATION DESC
LIMIT @CountryNum;

/*13*/
CREATE PROCEDURE GetData(@ContName CHAR(100), @CountryNum INT) 
AS BEGIN

SELECT A.NAME, B.NAME as COUNTRY, A.DISTRICT, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
WHERE B.CONTINENT = "@ContName"
ORDER BY A.POPULATION DESC
LIMIT @CountryNum;

/*14*/
CREATE PROCEDURE GetData(@RegionName CHAR(100), @CountryNum INT) 
AS BEGIN

SELECT A.NAME, B.NAME as COUNTRY, A.DISTRICT, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
WHERE B.REGION = "@RegionName"
ORDER BY A.POPULATION DESC
LIMIT @CountryNum;

/*15*/
CREATE PROCEDURE GetData(@CountryName CHAR(100), @CountryNum INT) 
AS BEGIN

SELECT A.NAME, B.NAME as COUNTRY, A.DISTRICT, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
WHERE B.NAME = "@CountryName"
ORDER BY A.POPULATION DESC
LIMIT @CountryNum;

/*16*/
CREATE PROCEDURE GetData(@DistrictName CHAR(100), @CountryNum INT) 
AS BEGIN

SELECT A.NAME, B.NAME as COUNTRY, A.DISTRICT, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
WHERE A.DISTRICT = "@DistrictName"
ORDER BY A.POPULATION DESC
LIMIT @CountryNum;

/*17*/
SELECT A.NAME, B.NAME AS COUNTRY, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.ID = B.CAPITAL
ORDER BY A.POPULATION DESC;

/*18*/
CREATE PROCEDURE GetData(@ContName CHAR(100)) 
AS BEGIN

SELECT A.NAME, B.NAME AS COUNTRY, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.ID = B.CAPITAL
WHERE B.CONTINENT = "@ContName"
ORDER BY A.POPULATION DESC;

/*19*/
CREATE PROCEDURE GetData(@RegionName CHAR(100)) 
AS BEGIN

SELECT A.NAME, B.NAME AS COUNTRY, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.ID = B.CAPITAL
WHERE B.REGION = "@RegionName"
ORDER BY A.POPULATION DESC;

/*20*/
CREATE PROCEDURE GetData(@CountryNum INT) 
AS BEGIN

SELECT A.NAME, B.NAME AS COUNTRY, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.ID = B.CAPITAL
ORDER BY A.POPULATION DESC
LIMIT @CountryNum;

/*21*/
CREATE PROCEDURE GetData(@ContName CHAR(100), @CountryNum INT) 
AS BEGIN

SELECT A.NAME, B.NAME AS COUNTRY, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.ID = B.CAPITAL
WHERE B.CONTINENT = "@ContName"
ORDER BY A.POPULATION DESC
LIMIT @CountryNum;

/*22*/
CREATE PROCEDURE GetData(@RegionName CHAR(100), @CountryNum INT) 
AS BEGIN

SELECT A.NAME, B.NAME AS COUNTRY, A.POPULATION
FROM CITY A
LEFT JOIN COUNTRY B ON A.ID = B.CAPITAL
WHERE B.REGION = "@RegionName"
ORDER BY A.POPULATION DESC
LIMIT @CountryNum;

/*23*/
CREATE TABLE TOTAL_POP AS
SELECT CONTINENT, SUM(POPULATION) AS TOTAL_POP
FROM COUNTRY
GROUP BY CONTINENT;

CREATE TABLE CITY_POP AS
SELECT B.CONTINENT, SUM(A.POPULATION) AS CITY_POP
FROM CITY A LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
GROUP BY B.CONTINENT;

CREATE TABLE CONTINENT AS
A.CONTINENT,
A.TOTAL_POP,
B.CITY_POP,
(B.CITY_POP/A.TOTAL_POP) AS CITY_POP_PERCENTAGE,
(A.TOTAL_POP - B.CITY_POP) AS NON_CITY_POP,
(CALCULATED NON_CITY_POP/A.TOTAL_POP) AS CITY_POP_PERCENTAGE
FROM TOTAL_POP A
LEFT JOIN CITY_POP B ON A.CONTINENT = B.CONTINENT;

/*24*/
CREATE TABLE TOTAL_POP AS
SELECT REGION, SUM(POPULATION) AS TOTAL_POP
FROM COUNTRY
GROUP BY REGION;

CREATE TABLE CITY_POP AS
SELECT B.REGION, SUM(A.POPULATION) AS CITY_POP
FROM CITY A LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
GROUP BY B.REGION;

CREATE TABLE REGION AS
A.REGION,
A.TOTAL_POP,
B.CITY_POP,
(B.CITY_POP/A.TOTAL_POP) AS CITY_POP_PERCENTAGE,
(A.TOTAL_POP - B.CITY_POP) AS NON_CITY_POP,
(CALCULATED NON_CITY_POP/A.TOTAL_POP) AS CITY_POP_PERCENTAGE
FROM TOTAL_POP A
LEFT JOIN CITY_POP B ON A.REGION = B.REGION;

/*25*/
CREATE TABLE TOTAL_POP AS
SELECT NAME, SUM(POPULATION) AS TOTAL_POP
FROM COUNTRY
GROUP BY NAME;

CREATE TABLE CITY_POP AS
SELECT B.NAME, SUM(A.POPULATION) AS CITY_POP
FROM CITY A LEFT JOIN COUNTRY B ON A.COUNTRYCODE = B.CODE
GROUP BY B.NAME;

CREATE TABLE REGION AS
A.NAME AS COUNTRY,
A.TOTAL_POP,
B.CITY_POP,
(B.CITY_POP/A.TOTAL_POP) AS CITY_POP_PERCENTAGE,
(A.TOTAL_POP - B.CITY_POP) AS NON_CITY_POP,
(CALCULATED NON_CITY_POP/A.TOTAL_POP) AS CITY_POP_PERCENTAGE
FROM TOTAL_POP A
LEFT JOIN CITY_POP B ON A.NAME = B.NAME;

/*26*/
SELECT SUM(POPULATION)
FROM COUNTRY;

/*27*/
CREATE PROCEDURE GetData(@ContName CHAR(100)) 
AS BEGIN

SELECT CONTINENT, SUM(POPULATION)
FROM COUNTRY
WHERE CONTINENT = "@ContName";

/*28*/
CREATE PROCEDURE GetData(@RegionName CHAR(100)) 
AS BEGIN

SELECT REGION, SUM(POPULATION)
FROM COUNTRY
WHERE REGION = "@RegionName";

/*29*/
CREATE PROCEDURE GetData(@CountryName CHAR(100)) 
AS BEGIN

SELECT REGION, SUM(POPULATION)
FROM COUNTRY
WHERE NAME = "@CountryName";

/*30*/
CREATE PROCEDURE GetData(@DistrictName CHAR(100)) 
AS BEGIN

SELECT DISTRICT, SUM(POPULATION)
FROM CITY
WHERE DISTRICT = "@CountryName";

/*31*/
CREATE PROCEDURE GetData(@CityName CHAR(100)) 
AS BEGIN

SELECT NAME, SUM(POPULATION)
FROM CITY
WHERE NAME = "@CityName";

/*32*/
CREATE TABLE TOP_LANGUAGE AS
SELECT A.LANGUAGE, A.PERCENTAGE, B.POPULATION, (A.PERCENTAGE * B.POPULATION) AS LANGUAGE_SPEAKERS
FROM COUNTRYLANGUAGE A
LEFT JOIN COUNTRY B A.COUNTRY = B.COUNTRYCODE
WHERE A.LANGUAGE IN('CHINESE', 'ENGLISH', 'HINDI', 'SPANISH', 'ARABIC')

CREATE TABLE LISTED_LANGUAGES AS
SELECT LANGUAGE, SUM(LANGUAGE_SPEAKERS) AS TOTAL_SPEAKERS, SUM(LANGUAGE_SPEAKERS)/(SELECT SUM(POPULATION) FROM COUNTRY) AS PERCENT_OF_WORLD_POP
FROM TOP_LANGUAGE
GROUP BY LANGUAGE
ORDER BY CALCULATED TOTAL_SPEAKERS DESC		
